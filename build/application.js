(function(){$(function(){var initialize,placeInfoWindow,placeMarker;return(initialize=function(){var map,mapOptions;return mapOptions={center:new google.maps.LatLng(35,139),zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP},map=new google.maps.Map(document.getElementById("map_canvas"),mapOptions),google.maps.event.addListener(map,"click",function(e){return placeMarker(e.latLng,map)})})(),placeMarker=function(position,map){var marker;return marker=new google.maps.Marker({position:position,map:map,title:"Wheater and webcams"}),placeInfoWindow(position,map,marker),map.panTo(position)},placeInfoWindow=function(position,map,marker){return $.when(weatherRequest(position),webcamRequest(position)).done(function(weatherResponse,webcamResponse){var infowindow;return window.webcamResponse=JSON.parse(webcamResponse[0]),infowindow=new google.maps.InfoWindow({content:getWeatherInfo(weatherResponse)+getWebcamInfo(webcamResponse)}),infowindow.open(map,marker)})}})}).call(this),function(){$(function(){return window.webcamRequest=function(position){return $.get("http://api.webcams.travel/rest",{lat:position.lat(),lng:position.lng(),method:"wct.webcams.list_nearby",devid:"d2a3f882246031d44de64607d65981fd",format:"json",radius:10,unit:"km"})},window.getWebcamInfo=function(response){var data,result,webcam,webcams;return data=JSON.parse(response[0]),result="success"===response[1]&&"ok"===data.status&&data.webcams.count?(webcams=function(){var _i,_len,_ref,_results;for(_ref=data.webcams.webcam,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)webcam=_ref[_i],_results.push("<p> Title: "+webcam.title+"<br> View count: "+webcam.view_count+"<br> <a href='"+webcam.url+"'><img src='"+webcam.thumbnail_url+"'></a> </p>");return _results}(),webcams.join("")):"<p>No webcams for this location</p>","<h3>Webcams</h3>"+result}})}.call(this),function(){$(function(){return window.weatherRequest=function(position){return $.get("http://api.openweathermap.org/data/2.5/weather",{lat:position.lat(),lon:position.lng(),APPID:"c9aedb4a466406c8ad44321c774fc6d3"})},window.getWeatherInfo=function(response){var data,result;return data=response[0],result="success"===response[1]?""+data.name+", "+data.sys.country+"<br> "+data.weather[0].main+"<br> "+data.weather[0].description+"<br> "+Math.round(data.main.temp-273.15)+" C&deg<br> Humidity: "+data.main.humidity+"%<br> Wind: "+data.wind.speed+"m/s<br>":"<p>No wheater forecast for this location</p>","<h3>Wheater forecast</h3>"+result}})}.call(this);